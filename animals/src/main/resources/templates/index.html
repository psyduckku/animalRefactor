<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/template/common/layout/defaultLayout.html}"
      layout:fragment="content">
<head>
  <link rel="stylesheet" th:href="@{/css/index.css}"/>
  <title>Document</title>
</head>
<body>
      <div class="parent">
        <div class="box info">info</div>
        <div class="box animal0">
          <div class="box animal_pic" id="main_pic0">

          </div>
          <div class="box animal_con" id="main_con0">

          </div>
        </div>
        <div class="box animal1">
          <div class="box animal_pic" id="main_pic1">

          </div>
          <div class="box animal_con" id="main_con1">

          </div>
        </div>
        <div class="box animal2">
          <div class="box animal_pic" id="main_pic2">

          </div>
          <div class="box animal_con" id="main_con2">

          </div>
        </div>
        <div class="box animal3">
          <div class="box animal_pic" id="main_pic3">

          </div>
          <div class="box animal_con" id="main_con3">

          </div>
        </div>
        <div class="box rList0">
          <div class="image"> <a id="a_img0"><img id="img0"></a> </div>
          <div>
            <ul class="side" id="side0">

            </ul>
          </div>
        </div>
        <div class="box rList1">
          <div class="image"><a id="a_img1"><img id="img1"></a></div>
          <div>
            <ul class="side" id="side1">

            </ul>
          </div>
        </div>
        <div class="box rList2">
          <div class="image"><a id="a_img2"><img id="img2"></a></div>
          <div>
            <ul class="side" id="side2">

            </ul>
          </div>
        </div>
</div>
</body>
<script th:inline="javascript">
  let data=null;
  let bookmark=null;
  let main_pic_div='';
  async function getAsideList() {
    try{
      const response = await fetch('/animalBoard/getAsideBoard', {
        headers: {
          'Content-Type': 'application/json'
        },
      })
       data = await response.json();
      for(i=0; i<= data.length; i++){
         let side = document.getElementById(`side${i}`);
         let li0 = document.createElement('li');
         let li1 = document.createElement('li');
         let li2 = document.createElement('li');
         let img= document.getElementById(`img${i}`)
         let a = document.getElementById(`a_img${i}`);
         li0.innerHTML = '<li> 지역 : ' + data[i].sigun_NM + '</li>';
         li1.innerHTML = '<li> 공고종료일: <br> ' + data[i].pblanc_END_DE +'</li>';
         li2.innerHTML = '<li> 종별 : ' + data[i].species_NM +'</li>';
         img.setAttribute('src', data[i].image_COURS);
         img.setAttribute('width', '180px');
         side.appendChild(li0);
         side.appendChild(li1);
         side.appendChild(li2);
         a.setAttribute('href', '/animalBoard/animalBoard?ASEQ='+data[i].aseq);
      }
    }catch(error){
      console.error(error);
    }
  }

  async function getBookmarkList() {

    try {
      const response = await fetch('/adoptBoard/bookmarkList', {
        headers: {
          'Content-Type': 'application/json',
        },
          'method' : 'POST',
      })
        if(response.ok){
          bookmark = await response.json();

          for(i=0; i<bookmark.thumbnailList.length;i++){
            main_pic_div =  document.getElementById(`main_pic${i}`);
            const main_con_div = document.getElementById(`main_con${i}`);
            const p_pic = document.createElement('p');
            const title_p = document.createElement('p');
            const content_p = document.createElement('p');
            p_pic.innerText= bookmark.thumbnailList[i].store_file_name;
            title_p.innerText = bookmark.boardList[i].title;
            content_p.innerText = bookmark.boardList[i].content;
            main_pic_div.appendChild(p_pic);
            main_con_div.appendChild(title_p);
            main_con_div.appendChild(content_p);
            console.log(main_pic_div);

          }
        }

    }catch(error){
      console.error(error);
    }
  }

  window.addEventListener('DOMContentLoaded', ()=>{
    getAsideList();
    getBookmarkList();
  });
</script>
</html>